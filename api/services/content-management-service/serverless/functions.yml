authorizer:
  handler: src/auth/authorizer.handler

customize_cognito_message:
  handler: src/auth/message_customizer.handler

get_venues_list:
  handler: src/venues/list.list
  events:
    - http:
        path: api/venues
        method: get
        cors: true

create_venue:
  handler: src/venues/create.create
  events:
    - http:
        path: api/venues
        method: post
        cors: true
        authorizer: ${self:custom.authorizer}

update_venue:
  handler: src/venues/update.update
  events:
    - http:
        path: api/venues/{id}
        method: put
        cors: true
        authorizer: ${self:custom.authorizer}

delete_venue:
  handler: src/venues/delete.delete
  events:
    - http:
        path: api/venues/{id}
        method: delete
        cors: true
        authorizer: ${self:custom.authorizer}

delete_screen_group:
  handler: src/venues/delete_screen_group.delete
  events:
    - http:
        path: api/venues/{id}/screen_groups/{group_id}
        method: delete
        cors: true
        authorizer: ${self:custom.authorizer}

delete_screen:
  handler: src/venues/delete_screen.delete
  events:
    - http:
        path: api/venues/{id}/screen_groups/{group_id}/screens/{screen_id}
        method: delete
        cors: true
        authorizer: ${self:custom.authorizer}

get_content_list:
  handler: src/content/list.list
  events:
    - http:
        path: api/content
        method: get
        cors: true

create_content:
  handler: src/content/create.create
  events:
    - http:
        path: api/content
        method: post
        cors: true
        authorizer: ${self:custom.authorizer}

get_settings_list:
  handler: src/setting/list.list
  events:
    - http:
        path: api/settings
        method: get
        cors: true

create_setting:
  handler: src/setting/create.create
  events:
    - http:
        path: api/settings
        method: post
        cors: true
        authorizer: ${self:custom.authorizer}

update_setting:
  handler: src/setting/update.update
  events:
    - http:
        path: api/settings/{id}
        method: put
        cors: true
        authorizer: ${self:custom.authorizer}

delete_setting:
  handler: src/setting/delete.delete
  events:
    - http:
        path: api/settings/{id}
        method: delete
        cors: true
        authorizer: ${self:custom.authorizer}

handle_settings_stream:
  handler: src/setting/stream/stream_handler.handleEvent
  environment: ${self:custom.properties.pusher}
  events:
    - stream:
        type: dynamodb
        arn:
          Fn::GetAtt:
            - SettingsTable
            - StreamArn

create_schedule:
  handler: src/schedule/create.create
  events:
    - http:
        path: api/schedules
        method: post
        cors: true
        authorizer: ${self:custom.authorizer}

get_schedules_list:
  handler: src/schedule/list.list
  events:
    - http:
        path: api/schedules
        method: get
        cors: true

update_schedule:
  handler: src/schedule/update.update
  events:
    - http:
        path: api/schedules/{id}
        method: put
        cors: true
        authorizer: ${self:custom.authorizer}

delete_schedule:
  handler: src/schedule/delete.delete
  events:
    - http:
        path: api/schedules/{id}
        method: delete
        cors: true
        authorizer: ${self:custom.authorizer}

handle_schedules_stream:
  handler: src/schedule/stream/stream_handler.handleEvent
  environment: ${self:custom.properties.pusher}
  events:
    - stream:
        type: dynamodb
        arn:
          Fn::GetAtt:
            - SchedulesTable
            - StreamArn

